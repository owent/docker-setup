# 定义哪些设备（AP 或交换机）允许向 RADIUS 发送请求。
# -----------------------------------------------------------------------
# clients.conf - 定义哪些设备（NAS/AP/交换机）允许请求认证
# -----------------------------------------------------------------------

# =======================================================================
# 1. 本地回环 (Localhost)
# =======================================================================

client localhost_ipv4 {
    ipaddr = 127.0.0.1
    proto = *
    secret = "Xy9-mP2@kL_5vR!z"
    nas_type = other
    limit {
        max_connections = 16
        lifetime = 0
        idle_timeout = 30
    }

    require_message_authenticator = yes
}

client localhost_ipv6 {
    ipv6addr = ::1
    secret = "Xy9-mP2@kL_5vR!z"

    require_message_authenticator = yes
}

# =======================================================================
# 2. IPv4 私有网段 (RFC 1918)
# =======================================================================

# Class A (10.0.0.0/8)
client private_ipv4_10 {
    ipaddr = 10.0.0.0/8
    proto = *
    secret = "Xy9-mP2@kL_5vR!z"   # <--- 请修改为您的密码
    nas_type = other

    require_message_authenticator = yes
}

# Class B (172.16.0.0/12)
client private_ipv4_172 {
    ipaddr = 172.16.0.0/12
    proto = *
    secret = "Xy9-mP2@kL_5vR!z"   # <--- 请修改为您的密码
    nas_type = other

    require_message_authenticator = yes
}

# Class C (192.168.0.0/16)
client private_ipv4_192 {
    ipaddr = 192.168.0.0/16
    proto = *
    secret = "Xy9-mP2@kL_5vR!z"   # <--- 请修改为您的密码
    nas_type = other

    require_message_authenticator = yes
}

# =======================================================================
# 3. IPv6 私有/本地网段
# =======================================================================

# ULA (Unique Local Address) - fc00::/7
# 包含 fc00::/8 和 fd00::/8
# 这是 IPv6 局域网最常用的段
client private_ipv6_ula {
    ipv6addr = fc00::/7
    proto = *
    secret = "Xy9-mP2@kL_5vR!z"   # <--- 请修改为您的密码
    nas_type = other

    require_message_authenticator = yes
}

# Link-Local Address - fe80::/10
# 链路本地地址 (通常用于同网段通信)
client private_ipv6_link_local {
    ipv6addr = fe80::/10
    proto = *
    secret = "Xy9-mP2@kL_5vR!z"   # <--- 请修改为您的密码
    nas_type = other

    require_message_authenticator = yes
}

# =======================================================================
# 动态客户端 (可选)
# 如果你使用了 dynamic_clients 模块，可以开启下面这段，否则保持注释
# =======================================================================
# client dynamic {
#   ipaddr = 0.0.0.0/0
#   proto = *
#   secret = dynamic_secret
#   dynamic_clients = dynamic_client_server
#
#   require_message_authenticator = yes
# }
