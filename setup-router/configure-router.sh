#!/bin/bash

export RUN_USER=tools
export ROUTER_HOME=/home/router
export ROUTER_DATA_ROOT_DIR=/data
export ROUTER_LOG_ROOT_DIR=$ROUTER_DATA_ROOT_DIR/logs

export DNSMASQ_DNS_PORT=6053

export GEOIP_GEOSITE_ETC_DIR=$ROUTER_HOME/etc/v2ray

export SMARTDNS_DNS_PORT=6153
export SMARTDNS_ETC_DIR=$ROUTER_HOME/etc/smartdns
export SMARTDNS_LOG_DIR=$ROUTER_LOG_ROOT_DIR/smartdns
export SMARTDNS_APPEND_CONFIGURE=""

export COREDNS_DNS_PORT=53

# Use radvd and ndp and disable NAT6
export NAT_SETUP_SKIP_IPV6=1

export ACMESH_SSL_DIR=$ROUTER_HOME/acme.sh/ssl
export SAMBA_DATA_DIR=$ROUTER_DATA_ROOT_DIR/samba
export NEXTCLOUD_DATA_DIR=$SAMBA_DATA_DIR/nextcloud/data
export NEXTCLOUD_APPS_DIR=$SAMBA_DATA_DIR/nextcloud/apps
export NEXTCLOUD_ETC_DIR=$SAMBA_DATA_DIR/nextcloud/etc
export NEXTCLOUD_TRUSTED_DOMAINS="" # nextcloud domains and IPs

TPROXY_SETUP_IPSET=1
TPROXY_SETUP_SMARTDNS=1
TPROXY_SETUP_DNSMASQ=1
TPROXY_SETUP_COREDNS=1

TPROXY_SETUP_COREDNS_WITH_NFTABLES=0
TPROXY_SETUP_NFTABLES_SET=0
TPROXY_WHITELIST_IPV4=("91.108.56.0/22" "95.161.64.0/20" "91.108.4.0/22" "91.108.8.0/22" "149.154.160.0/22" "149.154.164.0/22" "8.8.8.8" "8.8.4.4")
TPROXY_WHITELIST_IPV6=("2001:4860:4860::8888" "2001:4860:4860::8844")

"$@"
